# ============================================================================
# BrandKit Backend - Application Configuration
# FRD-001: User Registration and Authentication System
# ============================================================================

spring.application.name=brandkit-backend

# ============================================================================
# PostgreSQL/Supabase Configuration
# ============================================================================
spring.datasource.url=${DATABASE_URL:jdbc:postgresql://db.bpjmzqsfvqwcxznuvbyk.supabase.co:5432/postgres}
spring.datasource.username=${DATABASE_USERNAME:postgres}
spring.datasource.password=${DATABASE_PASSWORD:5tOm0OwrLPbqWMdI}
spring.datasource.driver-class-name=org.postgresql.Driver
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# ============================================================================
# JPA Configuration
# ============================================================================
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
# Hibernate auto-detects PostgreSQL dialect
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.jdbc.time_zone=UTC

# ============================================================================
# Flyway Migration Configuration
# ============================================================================
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration
spring.flyway.baseline-on-migrate=true
spring.flyway.validate-on-migrate=true

# ============================================================================
# Redis Configuration for Session/Rate Limiting
# ============================================================================
# Redis is disabled for now - enable when Redis server is available
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration,org.springframework.boot.autoconfigure.data.redis.RedisRepositoriesAutoConfiguration
# spring.data.redis.host=${REDIS_HOST:localhost}
# spring.data.redis.port=${REDIS_PORT:6379}
# spring.data.redis.password=${REDIS_PASSWORD:}
# spring.data.redis.timeout=2000ms

# ============================================================================
# Email Configuration (SendGrid/SMTP)
# ============================================================================
spring.mail.host=${MAIL_HOST:smtp.sendgrid.net}
spring.mail.port=${MAIL_PORT:587}
spring.mail.username=${MAIL_USERNAME:apikey}
spring.mail.password=${MAIL_PASSWORD:}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.connection-timeout=5000
spring.mail.properties.mail.smtp.timeout=5000
spring.mail.properties.mail.smtp.write-timeout=5000

# ============================================================================
# OAuth2 Configuration (Optional - set env vars to enable)
# ============================================================================
spring.security.oauth2.client.registration.google.client-id=${GOOGLE_CLIENT_ID:disabled}
spring.security.oauth2.client.registration.google.client-secret=${GOOGLE_CLIENT_SECRET:disabled}
spring.security.oauth2.client.registration.google.scope=email,profile
spring.security.oauth2.client.registration.google.redirect-uri={baseUrl}/api/auth/google/callback

spring.security.oauth2.client.registration.linkedin.client-id=${LINKEDIN_CLIENT_ID:disabled}
spring.security.oauth2.client.registration.linkedin.client-secret=${LINKEDIN_CLIENT_SECRET:disabled}
spring.security.oauth2.client.registration.linkedin.scope=r_liteprofile,r_emailaddress
spring.security.oauth2.client.registration.linkedin.redirect-uri={baseUrl}/api/auth/linkedin/callback
spring.security.oauth2.client.registration.linkedin.authorization-grant-type=authorization_code
spring.security.oauth2.client.registration.linkedin.client-name=LinkedIn

spring.security.oauth2.client.provider.linkedin.authorization-uri=https://www.linkedin.com/oauth/v2/authorization
spring.security.oauth2.client.provider.linkedin.token-uri=https://www.linkedin.com/oauth/v2/accessToken
spring.security.oauth2.client.provider.linkedin.user-info-uri=https://api.linkedin.com/v2/me
spring.security.oauth2.client.provider.linkedin.user-name-attribute=id

# ============================================================================
# Application-Specific Configuration
# ============================================================================

# CDN Configuration (FRD-002 Sub-Prompt 8)
app.cdn.base-url=${CDN_BASE_URL:https://cdn.brandkit.com}

# Storage Configuration (FRD-002 Sub-Prompt 8)
app.storage.type=${STORAGE_TYPE:local}
app.storage.max-images-per-product=8
app.storage.max-file-size=5242880
app.storage.upload-path=${UPLOAD_PATH:./uploads}

# S3 Configuration (when storage.type=s3)
app.s3.bucket=${S3_BUCKET:brandkit-products}
app.s3.region=${S3_REGION:ap-south-1}
app.s3.access-key=${S3_ACCESS_KEY:}
app.s3.secret-key=${S3_SECRET_KEY:}

# Product Configuration (FRD-002)
app.product.default-page-size=12
app.product.max-page-size=50
app.product.search-min-chars=2
app.product.customization-fee-base=10.00
app.product.customization-fee-embroidery=25.00
app.product.customization-fee-engraving=50.00
app.product.max-quantity=10000

# JWT Configuration (FRD-001 FR-9)
app.jwt.secret=${JWT_SECRET:your-256-bit-secret-key-must-be-at-least-32-characters-long}
app.jwt.access-token-expiry=15m
app.jwt.refresh-token-expiry=7d
app.jwt.refresh-token-extended=30d
app.jwt.issuer=brandkit

# Security Configuration (FRD-001 FR-12)
app.security.bcrypt-strength=10
app.security.max-login-attempts=5
app.security.captcha-threshold=3
app.security.lockout-duration=15m
app.security.rate-limit-requests=5
app.security.rate-limit-window=1m

# Token Expiry Configuration (FRD-001 FR-2, FR-7)
app.tokens.email-verification-expiry=24h
app.tokens.password-reset-expiry=1h

# Email Configuration
app.email.from=${MAIL_FROM:noreply@brandkit.in}
app.email.from-name=BrandKit
app.email.verification-subject=Verify Your BrandKit Account
app.email.password-reset-subject=Reset Your BrandKit Password

# Frontend URL for redirects
app.frontend.url=${FRONTEND_URL:http://localhost:3000}
app.frontend.verification-path=/auth/verify-email
app.frontend.password-reset-path=/auth/reset-password
app.frontend.login-path=/auth/login
app.frontend.dashboard-path=/dashboard

# Google reCAPTCHA Configuration
app.recaptcha.site-key=${RECAPTCHA_SITE_KEY:}
app.recaptcha.secret-key=${RECAPTCHA_SECRET_KEY:}
app.recaptcha.threshold=0.5

# ============================================================================
# Server Configuration
# ============================================================================
server.port=${SERVER_PORT:8080}
server.servlet.context-path=/
server.error.include-message=always
server.error.include-binding-errors=always

# ============================================================================
# Logging Configuration
# ============================================================================
logging.level.root=INFO
logging.level.com.brandkit=DEBUG
logging.level.org.springframework.security=DEBUG
logging.level.org.hibernate.SQL=DEBUG
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n

# ============================================================================
# Management/Actuator Endpoints
# ============================================================================
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=when-authorized
